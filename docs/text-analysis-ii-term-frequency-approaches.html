<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Text Analysis II: Term Frequency Approaches | An introduction to text analysis with R for sensory and consumer scientists</title>
  <meta name="description" content="6 Text Analysis II: Term Frequency Approaches | An introduction to text analysis with R for sensory and consumer scientists" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Text Analysis II: Term Frequency Approaches | An introduction to text analysis with R for sensory and consumer scientists" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Text Analysis II: Term Frequency Approaches | An introduction to text analysis with R for sensory and consumer scientists" />
  
  
  

<meta name="author" content="Jacob Lahne" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="text-analysis-i-fundamentals.html"/>
<link rel="next" href="text-analysis-iii-sentiment-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction and welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introductions"><i class="fa fa-check"></i>Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#jacob-lahne-phd"><i class="fa fa-check"></i>Jacob Lahne, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#leah-hamilton-phd"><i class="fa fa-check"></i>Leah Hamilton, PhD</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#martha-calvert-ms"><i class="fa fa-check"></i>Martha Calvert, MS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#todays-agenda"><i class="fa fa-check"></i>Today’s agenda</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-were-going-to-run"><i class="fa fa-check"></i>How we’re going to run</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recommended-approach-for-livecoding"><i class="fa fa-check"></i>Recommended approach for livecoding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dealing-with-errors"><i class="fa fa-check"></i>Dealing with errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html"><i class="fa fa-check"></i><b>1</b> A crash course in <code>R</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#r-vs-rstudio"><i class="fa fa-check"></i><b>1.1</b> <code>R</code> vs RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is <code>R</code>?</a></li>
<li class="chapter" data-level="1.1.2" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#great-why-are-we-using-rstudio-then"><i class="fa fa-check"></i><b>1.1.2</b> Great, why are we using RStudio then?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#the-parts-of-rstudio"><i class="fa fa-check"></i><b>1.2</b> The parts of RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#the-working-directory-and-why-you-should-care"><i class="fa fa-check"></i><b>1.2.1</b> The “working directory” and why you should care</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#extending-r-with-packages"><i class="fa fa-check"></i><b>1.3</b> Extending <code>R</code> with packages</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#installing-packages"><i class="fa fa-check"></i><b>1.3.1</b> Installing packages</a></li>
<li class="chapter" data-level="1.3.2" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#loading-packages"><i class="fa fa-check"></i><b>1.3.2</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#getting-help"><i class="fa fa-check"></i><b>1.4</b> Getting help</a></li>
<li class="chapter" data-level="1.5" data-path="a-crash-course-in-r.html"><a href="a-crash-course-in-r.html#livecoding-along"><i class="fa fa-check"></i><b>1.5</b> Livecoding along</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html"><i class="fa fa-check"></i><b>2</b> How to work with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#doing-math-and-creating-objects-in-r"><i class="fa fa-check"></i><b>2.1</b> Doing math and creating objects in <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#functions-and-their-arguments-in-r"><i class="fa fa-check"></i><b>2.2</b> Functions and their arguments in <code>R</code></a></li>
<li class="chapter" data-level="2.3" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.3</b> Reading data into <code>R</code></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#where-the-data-lives"><i class="fa fa-check"></i><b>2.3.1</b> Where the data lives</a></li>
<li class="chapter" data-level="2.3.2" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#what-kind-of-file-are-we-importing"><i class="fa fa-check"></i><b>2.3.2</b> What kind of file are we importing?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#data-in-r"><i class="fa fa-check"></i><b>2.4</b> Data in <code>R</code></a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#subsetting-data"><i class="fa fa-check"></i><b>2.4.1</b> Subsetting data</a></li>
<li class="chapter" data-level="2.4.2" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#complex-vectorslists-data.frame-and-tibble"><i class="fa fa-check"></i><b>2.4.2</b> Complex vectors/lists: <code>data.frame</code> and <code>tibble</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#subsetting-and-wrangling-data-tables"><i class="fa fa-check"></i><b>2.5</b> Subsetting and wrangling data tables</a></li>
<li class="chapter" data-level="2.6" data-path="how-to-work-with-r.html"><a href="how-to-work-with-r.html#psa-not-knowing-is-normal"><i class="fa fa-check"></i><b>2.6</b> PSA: not-knowing is normal!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Wrangling data with <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#subsetting-data-1"><i class="fa fa-check"></i><b>3.1</b> Subsetting data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#select-for-columns"><i class="fa fa-check"></i><b>3.1.1</b> <code>select()</code> for columns</a></li>
<li class="chapter" data-level="3.1.2" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#filter-for-rows"><i class="fa fa-check"></i><b>3.1.2</b> <code>filter()</code> for rows</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#combining-steps-with-the-pipe"><i class="fa fa-check"></i><b>3.2</b> Combining steps with the pipe: <code>%&gt;%</code></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#pipes-require-that-the-lefthand-side-be-a-single-functional-command"><i class="fa fa-check"></i><b>3.2.1</b> Pipes require that the lefthand side be a single functional command</a></li>
<li class="chapter" data-level="3.2.2" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#pipes-always-pass-the-result-of-the-lefthand-side-to-the-first-argument-of-the-righthand-side"><i class="fa fa-check"></i><b>3.2.2</b> Pipes always pass the result of the lefthand side to the <em>first</em> argument of the righthand side</a></li>
<li class="chapter" data-level="3.2.3" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#pipes-are-a-pain-to-type"><i class="fa fa-check"></i><b>3.2.3</b> Pipes are a pain to type</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#make-new-columns-mutate"><i class="fa fa-check"></i><b>3.3</b> Make new columns: <code>mutate()</code></a></li>
<li class="chapter" data-level="3.4" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#split-apply-combine-analyses-with-group_by-and-summarize"><i class="fa fa-check"></i><b>3.4</b> Split-apply-combine analyses with <code>group_by()</code> and <code>summarize()</code></a></li>
<li class="chapter" data-level="3.5" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#utilities-for-data-management"><i class="fa fa-check"></i><b>3.5</b> Utilities for data management</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#rename-your-columns"><i class="fa fa-check"></i><b>3.5.1</b> Rename your columns</a></li>
<li class="chapter" data-level="3.5.2" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#relocate-your-columns"><i class="fa fa-check"></i><b>3.5.2</b> Relocate your columns</a></li>
<li class="chapter" data-level="3.5.3" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#sort-your-data"><i class="fa fa-check"></i><b>3.5.3</b> Sort your data</a></li>
<li class="chapter" data-level="3.5.4" data-path="wrangling-data-with-tidyverse.html"><a href="wrangling-data-with-tidyverse.html#pivot-tables"><i class="fa fa-check"></i><b>3.5.4</b> Pivot tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html"><i class="fa fa-check"></i><b>4</b> Data visualization basics with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#your-first-ggplot"><i class="fa fa-check"></i><b>4.1</b> Your first <code>ggplot()</code></a></li>
<li class="chapter" data-level="4.2" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#the-aes-function-and-mapping-argument"><i class="fa fa-check"></i><b>4.2</b> The <code>aes()</code> function and <code>mapping =</code> argument</a></li>
<li class="chapter" data-level="4.3" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#adding-layers-with-geom_-functions"><i class="fa fa-check"></i><b>4.3</b> Adding layers with <code>geom_*()</code> functions</a></li>
<li class="chapter" data-level="4.4" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#arguments-inside-and-outside-of-aes"><i class="fa fa-check"></i><b>4.4</b> Arguments inside and outside of <code>aes()</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#using-theme_-to-change-visual-options-quickly"><i class="fa fa-check"></i><b>4.4.1</b> Using <code>theme_*()</code> to change visual options quickly</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#changing-aesthetic-elements-with-scale_-functions"><i class="fa fa-check"></i><b>4.4.2</b> Changing aesthetic elements with <code>scale_*()</code> functions</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#finally-facet_"><i class="fa fa-check"></i><b>4.4.3</b> Finally, <code>facet_*()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-visualization-basics-with-ggplot2.html"><a href="data-visualization-basics-with-ggplot2.html#some-further-reading"><i class="fa fa-check"></i><b>4.5</b> Some further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="text-analysis-i-fundamentals.html"><a href="text-analysis-i-fundamentals.html"><i class="fa fa-check"></i><b>5</b> Text Analysis I: Fundamentals</a>
<ul>
<li class="chapter" data-level="5.1" data-path="text-analysis-i-fundamentals.html"><a href="text-analysis-i-fundamentals.html#getting-your-text-data"><i class="fa fa-check"></i><b>5.1</b> Getting your text data</a></li>
<li class="chapter" data-level="5.2" data-path="text-analysis-i-fundamentals.html"><a href="text-analysis-i-fundamentals.html#basic-import-and-cleaning-with-text-data"><i class="fa fa-check"></i><b>5.2</b> Basic import and cleaning with text data</a></li>
<li class="chapter" data-level="5.3" data-path="text-analysis-i-fundamentals.html"><a href="text-analysis-i-fundamentals.html#where-is-the-data-in-character-a-tidy-approach."><i class="fa fa-check"></i><b>5.3</b> Where is the data in <code>character</code>? A <em>tidy</em> approach.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html"><i class="fa fa-check"></i><b>6</b> Text Analysis II: Term Frequency Approaches</a>
<ul>
<li class="chapter" data-level="6.1" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html#basic-text-analysis-approaches-using-tokens"><i class="fa fa-check"></i><b>6.1</b> Basic text analysis approaches using tokens</a></li>
<li class="chapter" data-level="6.2" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html#word-counts"><i class="fa fa-check"></i><b>6.2</b> Word counts</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html#stop-words"><i class="fa fa-check"></i><b>6.2.1</b> “stop words”</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html#term-frequency-inverse-document-frequency-tf-idf"><i class="fa fa-check"></i><b>6.3</b> Term Frequency-Inverse Document Frequency (TF-IDF)</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html#term-frequency"><i class="fa fa-check"></i><b>6.3.1</b> Term Frequency</a></li>
<li class="chapter" data-level="6.3.2" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html#inverse-document-frequency"><i class="fa fa-check"></i><b>6.3.2</b> Inverse Document Frequency</a></li>
<li class="chapter" data-level="6.3.3" data-path="text-analysis-ii-term-frequency-approaches.html"><a href="text-analysis-ii-term-frequency-approaches.html#applying-tf-idf-in-tidytext"><i class="fa fa-check"></i><b>6.3.3</b> Applying tf-idf in <code>tidytext</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="text-analysis-iii-sentiment-analysis.html"><a href="text-analysis-iii-sentiment-analysis.html"><i class="fa fa-check"></i><b>7</b> Text Analysis III: Sentiment Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="text-analysis-iii-sentiment-analysis.html"><a href="text-analysis-iii-sentiment-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>7.1</b> Sentiment analysis</a></li>
<li class="chapter" data-level="7.2" data-path="text-analysis-iii-sentiment-analysis.html"><a href="text-analysis-iii-sentiment-analysis.html#n-gram-models"><i class="fa fa-check"></i><b>7.2</b> <em>n</em>-gram models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html"><i class="fa fa-check"></i><b>8</b> Wrap-up and further resources</a>
<ul>
<li class="chapter" data-level="8.1" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#getting-help-1"><i class="fa fa-check"></i><b>8.1</b> Getting help</a></li>
<li class="chapter" data-level="8.2" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#further-readingresources"><i class="fa fa-check"></i><b>8.2</b> Further reading/resources</a></li>
<li class="chapter" data-level="8.3" data-path="wrap-up-and-further-resources.html"><a href="wrap-up-and-further-resources.html#questionscomments"><i class="fa fa-check"></i><b>8.3</b> Questions/Comments</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An introduction to text analysis with R for sensory and consumer scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="text-analysis-ii-term-frequency-approaches" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Text Analysis II: Term Frequency Approaches<a href="text-analysis-ii-term-frequency-approaches.html#text-analysis-ii-term-frequency-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="basic-text-analysis-approaches-using-tokens" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Basic text analysis approaches using tokens<a href="text-analysis-ii-term-frequency-approaches.html#basic-text-analysis-approaches-using-tokens" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve now seen how to import and clean text, and to transform text data into one useful format for analysis: a tidy table of tokens. (There are certainly other useful formats, but we will not be covering them here.)</p>
<p>Now we get to the actually interesting part. We’re going to tackle some basic but powerful approaches for parsing the meaning of large volumes of text.</p>
</div>
<div id="word-counts" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Word counts<a href="text-analysis-ii-term-frequency-approaches.html#word-counts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A common approach for getting a quick, analytic summary of the nature of the tokens (observations) in our reviews might be to look at the frequency of word use across reviews: this is pretty closely equivalent to a Check-All-That-Apply (CATA) framework: we will look how often each term is used, and will then extend this to categories of interest to our analysis. So, for example, we might have hypotheses like the following that we could hope to investigate using word frequencies:</p>
<ol style="list-style-type: decimal">
<li>Overall, flavor words are the most frequently used words in reviews of beer online.</li>
<li>The frequency of flavor-related words will be different for major categories of beer, like “hop”-related words for IPAs and “chocolate”/“coffee” terms for stouts.</li>
<li>The top flavor words will be qualitatively more positive for reviews associated with the top 10% of ratings, and negative for reviews associated with the bottom 10%.</li>
</ol>
<p>I will not be exploring each of these in this section of the workshop because of time constraints, but hopefully you’ll be able to use the tools I will demonstrate to solve these problems on your own.</p>
<p>Let’s start by combining our tidy data wrangling skills from <code>tidyverse</code> with our newly tidied text data from <code>unnest_tokens()</code> to try to test the first answer.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-1" aria-hidden="true" tabindex="-1"></a>beer_data_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The count() function gives the number of rows that contain unique values</span></span>
<span id="cb193-3"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(token) <span class="sc">%&gt;%</span></span>
<span id="cb193-4"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the 20 most frequently occurring words</span></span>
<span id="cb193-5"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, <span class="at">n =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb193-6"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here we do some wrangling for visualization</span></span>
<span id="cb193-7"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">token =</span> <span class="fu">as.factor</span>(token) <span class="sc">%&gt;%</span> <span class="fu">fct_reorder</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb193-8"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># let&#39;s visualize this just for fun</span></span>
<span id="cb193-9"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> token, <span class="at">y =</span> n)) <span class="sc">+</span> </span>
<span id="cb193-10"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb193-11"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb193-12"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb193-13"><a href="text-analysis-ii-term-frequency-approaches.html#cb193-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;The 20 most frequent words are not that useful.&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/what%20are%20the%20most%20frequent%20words%20in%20our%20beer%20data?-1.png" width="672" /></p>
<p>Unfortunately for our first hypothesis, we have quickly encountered a common problem in token-based text analysis. The most frequent words in most languages are “helper” words that are necessary for linguistic structure and communication, but are not unique to a particular topic or context. For example, in English the articles <code>a</code>, and <code>the</code> tend to be the most frequent tokens in any text because they are so ubiquitous.</p>
<p>It takes us until the 15th most frequent word, <code>head</code>, to find a word that might have sensory or product implications.</p>
<p>So, in order to find meaning in our text, we need to find some way to look past these terms, whose frequency vastly outnumbers words we are actually interested in.</p>
<div id="stop-words" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> “stop words”<a href="text-analysis-ii-term-frequency-approaches.html#stop-words" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In computational linguistics, this kind of word is often called a <strong>stop word</strong>: a word that is functionally important but does not tell us much about the meaning of the text. There are many common lists of such stop words, and in fact the <code>tidytext</code> package provides one such list in the <code>stop_words</code> tibble:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb194-1" aria-hidden="true" tabindex="-1"></a>stop_words</span></code></pre></div>
<pre><code>## # A tibble: 1,149 × 2
##    word        lexicon
##    &lt;chr&gt;       &lt;chr&gt;  
##  1 a           SMART  
##  2 a&#39;s         SMART  
##  3 able        SMART  
##  4 about       SMART  
##  5 above       SMART  
##  6 according   SMART  
##  7 accordingly SMART  
##  8 across      SMART  
##  9 actually    SMART  
## 10 after       SMART  
## # … with 1,139 more rows
## # ℹ Use `print(n = ...)` to see more rows</code></pre>
<p>The most basic approach to dealing with stop words is just to outright remove them from our data. This is easy when we’ve got a tidy, one-token-per-row structure.</p>
<p>We could use some version of <code>filter()</code> to remove stop words from our <code>beer_data_tokenized</code> tibble, but this is exactly what the <code>anti_join()</code> function (familiar to those of you who have used SQL) will do: with two tibbles, <code>X</code> and <code>Y</code>, <code>anti_join(X, Y)</code> will remove all rows in <code>X</code> that match rows in <code>Y</code>.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-1" aria-hidden="true" tabindex="-1"></a>beer_data_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &quot;by = &quot; tells what column to look for in X and Y</span></span>
<span id="cb196-3"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(<span class="at">y =</span> stop_words, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;token&quot;</span> <span class="ot">=</span> <span class="st">&quot;word&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb196-4"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(token) <span class="sc">%&gt;%</span></span>
<span id="cb196-5"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the 20 most frequently occurring words</span></span>
<span id="cb196-6"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, <span class="at">n =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-7"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here we do some wrangling for visualization</span></span>
<span id="cb196-8"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">token =</span> <span class="fu">as.factor</span>(token) <span class="sc">%&gt;%</span> <span class="fu">fct_reorder</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb196-9"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># let&#39;s visualize this just for fun</span></span>
<span id="cb196-10"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> token, <span class="at">y =</span> n)) <span class="sc">+</span> </span>
<span id="cb196-11"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb196-12"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb196-13"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb196-14"><a href="text-analysis-ii-term-frequency-approaches.html#cb196-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;These tokens are much more relevant.&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;We removed ~1200 stop words.&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/what%20are%20the%20most%20frequent%20NON%20stop%20words%20in%20beer%20data?-1.png" width="672" /></p>
<p>Now we are able to address our very first hypothesis: while the most common term (beer) might be in fact a stop word for this data set, the next 11 top terms all seem to have quite a lot to do with flavor.</p>
<p>We can extend this approach just a bit to provide the start of one answer to our second question: are there different most-used flavor terms for different beer styles? We can start to tackle this by first defining a couple of categories (since there are a lot of different styles in this dataset):</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb197-1" aria-hidden="true" tabindex="-1"></a>beer_data <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(style)</span></code></pre></div>
<pre><code>## # A tibble: 99 × 2
##    style                              n
##    &lt;chr&gt;                          &lt;int&gt;
##  1 Altbier                          186
##  2 American Adjunct Lager           961
##  3 American Amber / Red Ale         653
##  4 American Amber / Red Lager       235
##  5 American Barleywine              187
##  6 American Black Ale                10
##  7 American Blonde Ale              251
##  8 American Brown Ale               166
##  9 American Dark Wheat Ale           11
## 10 American Double / Imperial IPA   151
## # … with 89 more rows
## # ℹ Use `print(n = ...)` to see more rows</code></pre>
<p>Let’s just look at the categories I suggested, plus “lager”. We will do this by using mutate to create a <code>simple_style</code> column:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we&#39;ll make sure our approach works</span></span>
<span id="cb199-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-2" aria-hidden="true" tabindex="-1"></a>beer_data <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First we will set our style to lower case to make matching easier</span></span>
<span id="cb199-4"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">style =</span> <span class="fu">tolower</span>(style),</span>
<span id="cb199-5"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Then we will use a conditional match to create our new style</span></span>
<span id="cb199-6"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">simple_style =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(style, <span class="st">&quot;lager&quot;</span>) <span class="sc">~</span> <span class="st">&quot;lager&quot;</span>,</span>
<span id="cb199-7"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">str_detect</span>(style, <span class="st">&quot;ipa&quot;</span>) <span class="sc">~</span> <span class="st">&quot;IPA&quot;</span>,</span>
<span id="cb199-8"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">str_detect</span>(style, <span class="st">&quot;stout|porter&quot;</span>) <span class="sc">~</span> <span class="st">&quot;dark&quot;</span>,</span>
<span id="cb199-9"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;other&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb199-10"><a href="text-analysis-ii-term-frequency-approaches.html#cb199-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(simple_style)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   simple_style     n
##   &lt;chr&gt;        &lt;int&gt;
## 1 dark          2562
## 2 IPA           1274
## 3 lager         3245
## 4 other        13278</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we&#39;ll implement the approach for our tokenized data</span></span>
<span id="cb201-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-2" aria-hidden="true" tabindex="-1"></a>beer_data_tokenized <span class="ot">&lt;-</span> </span>
<span id="cb201-3"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-3" aria-hidden="true" tabindex="-1"></a>  beer_data_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb201-4"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">style =</span> <span class="fu">tolower</span>(style),</span>
<span id="cb201-5"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-5" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Then we will use a conditional match to create our new style</span></span>
<span id="cb201-6"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">simple_style =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(style, <span class="st">&quot;lager&quot;</span>) <span class="sc">~</span> <span class="st">&quot;lager&quot;</span>,</span>
<span id="cb201-7"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">str_detect</span>(style, <span class="st">&quot;ipa&quot;</span>) <span class="sc">~</span> <span class="st">&quot;IPA&quot;</span>,</span>
<span id="cb201-8"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">str_detect</span>(style, <span class="st">&quot;stout|porter&quot;</span>) <span class="sc">~</span> <span class="st">&quot;dark&quot;</span>,</span>
<span id="cb201-9"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;other&quot;</span>)) </span>
<span id="cb201-10"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-11"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we&#39;ll plot the most frequent terms for each simple_style</span></span>
<span id="cb201-12"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-12" aria-hidden="true" tabindex="-1"></a>beer_data_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb201-13"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter out stop words</span></span>
<span id="cb201-14"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;token&quot;</span> <span class="ot">=</span> <span class="st">&quot;word&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb201-15"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This time we count tokens WITHIN simple_style</span></span>
<span id="cb201-16"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(simple_style, token) <span class="sc">%&gt;%</span></span>
<span id="cb201-17"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then we will group_by the simple_style</span></span>
<span id="cb201-18"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(simple_style) <span class="sc">%&gt;%</span></span>
<span id="cb201-19"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, <span class="at">n =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb201-20"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Removing the group_by is necessary for some steps</span></span>
<span id="cb201-21"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb201-22"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A bit of wrangling for plotting</span></span>
<span id="cb201-23"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">token =</span> <span class="fu">as.factor</span>(token) <span class="sc">%&gt;%</span> <span class="fu">reorder_within</span>(<span class="at">by =</span> n, <span class="at">within =</span> simple_style)) <span class="sc">%&gt;%</span></span>
<span id="cb201-24"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> token, <span class="at">y =</span> n, <span class="at">fill =</span> simple_style)) <span class="sc">+</span></span>
<span id="cb201-25"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb201-26"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>simple_style, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb201-27"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span> </span>
<span id="cb201-28"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb201-29"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb201-30"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;Different (sensory) words tend to be used with different styles.&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-31"><a href="text-analysis-ii-term-frequency-approaches.html#cb201-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/what%20words%20are%20associated%20with%20some%20basic%20beer%20styles?-1.png" width="672" /></p>
</div>
</div>
<div id="term-frequency-inverse-document-frequency-tf-idf" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Term Frequency-Inverse Document Frequency (TF-IDF)<a href="text-analysis-ii-term-frequency-approaches.html#term-frequency-inverse-document-frequency-tf-idf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen that removing stop words dramatically increases the quality of our analysis in regards to our specific answers. However, you may be asking yourself: “how do I know what <em>counts as</em> as a stop word?” For example, we see that “beer” is near the top of the list of most frequent tokens for all 4 categories we defined–it is not useful to us–but it is not part of the <code>stop_words</code> tibble. We could, of course, manually remove it (something like <code>filter(token != "beer")</code>). But removing each stop word manually requires us to make <em>a priori</em> judgments about our data, which is not ideal.</p>
<p>One approach that takes a statistical approach to identifying and filtering stop words without the need to define them <em>a priori</em> is the <strong>tf-idf</strong> statistic, which stands for <strong>Term Frequency-Inverse Document Frequency</strong>.</p>
<p>tf-idf requires not just defining tokens, as we have done already using the <code>unnest_tokens()</code> function, but defining “documents” for your specific dataset. The term “document” is somewhat misleading, as it is merely a categorical variable that tells us distinct units in which we want to compare the frequency of our tokens. So in our dataset, <code>simple_style</code> is one such document categorization (representing 4 distinct “documents”); we could also use <code>style</code>, representing 99 distinct categories (“documents”), or any other categorical variable.</p>
<p>The reason that we need to define a “document” variable for our dataset is that td-idf will answer, in general, the following question:</p>
<blockquote>
<p>Given a set of “documents”, what tokens are most frequent <em>within</em> each unique document, but are not common <em>between</em> all documents?</p>
</blockquote>
<p>Defined this way, it is clear that tf-idf has an empirical kinship with all kinds of within/between statistics that we use on a daily basis. In practice, tf-idf is a simple product of two empirical properties of each token in the dataset.</p>
<div id="term-frequency" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Term Frequency<a href="text-analysis-ii-term-frequency-approaches.html#term-frequency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>tf</strong> is defined simply for each combination of document and token as the raw count of that token in that document, divided by the sum of raw counts of all tokens in that document.</p>
<center>
<span class="math inline">\(\text{tf}(t, d) = \frac{count_{t}}{\sum_{t \in d}{count_{t}}}\)</span>
</center>
<p>This quantity may be modified (for example, by using smoothing with <span class="math inline">\(\log{(1 + count_{t})}\)</span>). Exact implementations can vary.</p>
</div>
<div id="inverse-document-frequency" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Inverse Document Frequency<a href="text-analysis-ii-term-frequency-approaches.html#inverse-document-frequency" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>idf</strong> is an empirical estimate of how good a particular token is at distinguishing one “document” from another. It is defined as the logarithm of the total number of documents, divided by the the number of documents that contain the term in question.</p>
<center>
<span class="math inline">\(\text{idf}(t, D) = \log{\frac{N_D}{|\{{d \in D \ : \ t \in d\}|}}}\)</span>
</center>
<p>Where <span class="math inline">\(D\)</span> is the set of documents in the dataset.</p>
<p>Remember that we obtain the tf-idf by <em>multiplying</em> the two terms, which explains the inverse fraction–if we imagined a “tf/df” with division, the definition of the document frequency might be more intuitive but less numerically tractable.</p>
</div>
<div id="applying-tf-idf-in-tidytext" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Applying tf-idf in <code>tidytext</code><a href="text-analysis-ii-term-frequency-approaches.html#applying-tf-idf-in-tidytext" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Overall, the <strong>tf</strong> part of tf-idf is just a scaled what we’ve been doing so far. But the <strong>idf</strong> part provides a measure of validation. For our very frequent terms, that we have been removing as stop words, the tf might be high (they occur a lot) but the idf will be extremely small–all documents use tokens like <code>the</code> and <code>is</code>, so they provide little discriminatory power between documents. Ideally, then, tf-idf will give us a way to drop out stop words without the need to specify them <em>a priori</em>.</p>
<p>Happily, we don’t have to figure out a function for calculating tf-idf ourselves; <code>tidytext</code> provides the <code>bind_tf_idf()</code> function. The only requirement is that we have a data frame that provides a per-“document” count for each token, which we have already done above:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s first experiment with our &quot;simple_styles&quot;</span></span>
<span id="cb202-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-2" aria-hidden="true" tabindex="-1"></a>beer_styles_tf_idf <span class="ot">&lt;-</span></span>
<span id="cb202-3"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-3" aria-hidden="true" tabindex="-1"></a>  beer_data_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb202-4"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(simple_style, token) <span class="sc">%&gt;%</span></span>
<span id="cb202-5"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># And now we can directly add on tf-idf</span></span>
<span id="cb202-6"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_tf_idf</span>(<span class="at">term =</span> token, <span class="at">document =</span> simple_style, <span class="at">n =</span> n)</span>
<span id="cb202-7"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-8"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-8" aria-hidden="true" tabindex="-1"></a>beer_styles_tf_idf <span class="sc">%&gt;%</span></span>
<span id="cb202-9"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># let&#39;s look at some stop words</span></span>
<span id="cb202-10"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(token <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;is&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;the&quot;</span>, <span class="st">&quot;beer&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb202-11"><a href="text-analysis-ii-term-frequency-approaches.html#cb202-11" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>()</span></code></pre></div>
<div id="finhpmnpfs" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#finhpmnpfs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#finhpmnpfs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#finhpmnpfs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#finhpmnpfs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#finhpmnpfs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#finhpmnpfs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#finhpmnpfs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#finhpmnpfs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#finhpmnpfs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#finhpmnpfs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#finhpmnpfs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#finhpmnpfs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#finhpmnpfs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#finhpmnpfs .gt_from_md > :first-child {
  margin-top: 0;
}

#finhpmnpfs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#finhpmnpfs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#finhpmnpfs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#finhpmnpfs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#finhpmnpfs .gt_row_group_first td {
  border-top-width: 2px;
}

#finhpmnpfs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#finhpmnpfs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#finhpmnpfs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#finhpmnpfs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#finhpmnpfs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#finhpmnpfs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#finhpmnpfs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#finhpmnpfs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#finhpmnpfs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#finhpmnpfs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#finhpmnpfs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#finhpmnpfs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#finhpmnpfs .gt_left {
  text-align: left;
}

#finhpmnpfs .gt_center {
  text-align: center;
}

#finhpmnpfs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#finhpmnpfs .gt_font_normal {
  font-weight: normal;
}

#finhpmnpfs .gt_font_bold {
  font-weight: bold;
}

#finhpmnpfs .gt_font_italic {
  font-style: italic;
}

#finhpmnpfs .gt_super {
  font-size: 65%;
}

#finhpmnpfs .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#finhpmnpfs .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#finhpmnpfs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#finhpmnpfs .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#finhpmnpfs .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#finhpmnpfs .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">simple_style</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">token</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">tf</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">idf</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">tf_idf</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">dark</td>
<td class="gt_row gt_left">a</td>
<td class="gt_row gt_right">10322</td>
<td class="gt_row gt_right">0.045447741</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">dark</td>
<td class="gt_row gt_left">beer</td>
<td class="gt_row gt_right">2041</td>
<td class="gt_row gt_right">0.008986518</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">dark</td>
<td class="gt_row gt_left">is</td>
<td class="gt_row gt_right">4682</td>
<td class="gt_row gt_right">0.020614835</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">dark</td>
<td class="gt_row gt_left">the</td>
<td class="gt_row gt_right">10610</td>
<td class="gt_row gt_right">0.046715804</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">IPA</td>
<td class="gt_row gt_left">a</td>
<td class="gt_row gt_right">5285</td>
<td class="gt_row gt_right">0.045000937</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">IPA</td>
<td class="gt_row gt_left">beer</td>
<td class="gt_row gt_right">1151</td>
<td class="gt_row gt_right">0.009800582</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">IPA</td>
<td class="gt_row gt_left">is</td>
<td class="gt_row gt_right">2364</td>
<td class="gt_row gt_right">0.020129085</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">IPA</td>
<td class="gt_row gt_left">the</td>
<td class="gt_row gt_right">5630</td>
<td class="gt_row gt_right">0.047938557</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">lager</td>
<td class="gt_row gt_left">a</td>
<td class="gt_row gt_right">11868</td>
<td class="gt_row gt_right">0.045791277</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">lager</td>
<td class="gt_row gt_left">beer</td>
<td class="gt_row gt_right">3773</td>
<td class="gt_row gt_right">0.014557675</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">lager</td>
<td class="gt_row gt_left">is</td>
<td class="gt_row gt_right">5628</td>
<td class="gt_row gt_right">0.021714974</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">lager</td>
<td class="gt_row gt_left">the</td>
<td class="gt_row gt_right">10734</td>
<td class="gt_row gt_right">0.041415872</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">other</td>
<td class="gt_row gt_left">a</td>
<td class="gt_row gt_right">55217</td>
<td class="gt_row gt_right">0.047339678</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">other</td>
<td class="gt_row gt_left">beer</td>
<td class="gt_row gt_right">12491</td>
<td class="gt_row gt_right">0.010709019</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">other</td>
<td class="gt_row gt_left">is</td>
<td class="gt_row gt_right">23222</td>
<td class="gt_row gt_right">0.019909122</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
    <tr><td class="gt_row gt_left">other</td>
<td class="gt_row gt_left">the</td>
<td class="gt_row gt_right">53203</td>
<td class="gt_row gt_right">0.045612997</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
<p>We can see that, despite very high raw counts for all of these terms, the tf-idf is 0! They do not discriminate across our document categories at all, and so if we start looking for terms with high tf-idf, these will drop out completely.</p>
<p>Let’s take a look at the same visualization we made before with raw counts, but now with tf-idf.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-1" aria-hidden="true" tabindex="-1"></a>beer_styles_tf_idf <span class="sc">%&gt;%</span></span>
<span id="cb203-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We still group by simple_style</span></span>
<span id="cb203-3"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(simple_style) <span class="sc">%&gt;%</span></span>
<span id="cb203-4"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now we want tf-idf, not raw count</span></span>
<span id="cb203-5"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> tf_idf, <span class="at">n =</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-6"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb203-7"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A bit of wrangling for plotting</span></span>
<span id="cb203-8"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">token =</span> <span class="fu">as.factor</span>(token) <span class="sc">%&gt;%</span> <span class="fu">reorder_within</span>(<span class="at">by =</span> tf_idf, <span class="at">within =</span> simple_style)) <span class="sc">%&gt;%</span></span>
<span id="cb203-9"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> token, <span class="at">y =</span> tf_idf, <span class="at">fill =</span> simple_style)) <span class="sc">+</span></span>
<span id="cb203-10"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb203-11"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>simple_style, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb203-12"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span> </span>
<span id="cb203-13"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb203-14"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb203-15"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb203-16"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb203-17"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;With tf-idf we get much more specific terms.&quot;</span>, </span>
<span id="cb203-18"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;For example, &#39;oatmeal&#39; for stouts, &#39;grapefruity&#39; for IPAs, and so on.&quot;</span>) <span class="sc">+</span></span>
<span id="cb203-19"><a href="text-analysis-ii-term-frequency-approaches.html#cb203-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/what%20words%20are%20most%20important%20for%20our%20simple%20styles%20by%20tf-idf?-1.png" width="672" /></p>
<p>Thus, tf-idf gives us a flexible, empirical (data-based) model that will surface unique terms for us directly from the data. We can apply the same approach, for example, with a bit of extra wrangling, to see what terms are most associated with beers from the bottom and top deciles by rating (starting to address hypothesis #3):</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-1" aria-hidden="true" tabindex="-1"></a>beer_data_tokenized <span class="sc">%&gt;%</span></span>
<span id="cb204-2"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First we get deciles of rating</span></span>
<span id="cb204-3"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rating_decile =</span> <span class="fu">ntile</span>(rating, <span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb204-4"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># And we&#39;ll select just the top 2 and bottom 2 deciles %&gt;%</span></span>
<span id="cb204-5"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rating_decile <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb204-6"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then we follow the exact same pipeline to get tf-idf</span></span>
<span id="cb204-7"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(rating_decile, token) <span class="sc">%&gt;%</span></span>
<span id="cb204-8"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_tf_idf</span>(<span class="at">term =</span> token, <span class="at">document =</span> rating_decile, <span class="at">n =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb204-9"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rating_decile) <span class="sc">%&gt;%</span></span>
<span id="cb204-10"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Since we have more groups, we&#39;ll just look at 10 tokens</span></span>
<span id="cb204-11"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> tf_idf, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb204-12"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb204-13"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A bit of wrangling for plotting</span></span>
<span id="cb204-14"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">token =</span> <span class="fu">as.factor</span>(token) <span class="sc">%&gt;%</span> <span class="fu">reorder_within</span>(<span class="at">by =</span> tf_idf, <span class="at">within =</span> rating_decile)) <span class="sc">%&gt;%</span></span>
<span id="cb204-15"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> token, <span class="at">y =</span> tf_idf, <span class="at">fill =</span> rating_decile)) <span class="sc">+</span></span>
<span id="cb204-16"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb204-17"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rating_decile, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb204-18"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span> </span>
<span id="cb204-19"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb204-20"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb204-21"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb204-22"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb204-23"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb204-24"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;When we compare the top 2 and bottom 2 deciles, we see much more affective language.&quot;</span>) <span class="sc">+</span></span>
<span id="cb204-25"><a href="text-analysis-ii-term-frequency-approaches.html#cb204-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/what%20words%20are%20associated%20with%20very%20good%20or%20bad%20beers%20by%20tf-idf?-1.png" width="672" /></p>
<p>And important point to keep in mind about tf-idf is that it is <strong>data-based</strong>: the numbers are only meaningful within the specific set of tokens and documents. Thus, if I repeat the above pipeline but include all 10 deciles, we will not see the same words (and we will see that the model immediately struggles to find meaningful terms at all). This is because I am no longer calculating with 4 documents, but 10. These statistics are best thought of as descriptive, especially when we are repeatedly using them to explore a dataset.</p>
<p>&lt;img src=“_main_files/figure-html/tf-idf is data-based so it will change with “document” choice-1.png” width=“672” /&gt;</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="text-analysis-i-fundamentals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="text-analysis-iii-sentiment-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
